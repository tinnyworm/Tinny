library(ROCR)

train   <-  read.csv( file='./train.csv',  header=T, sep="|")
test    <-  read.csv( file='./test.csv', header=T, sep="|")

logreg <- glm( Target ~ ., data=train, family="binomial" )

trainPred   <- predict(logreg, train, type="response")
testPred    <- predict(logreg, test,  type="response")

trainRocPred   <- ROCR::prediction( trainPred, train$Target )
testRocPred    <- ROCR::prediction( testPred,  test$Target )

trainPerf   <- ROCR::performance( trainRocPred, "prec", "rec" )
testPerf    <- ROCR::performance( testRocPred,  "prec", "rec" )

trainAUC     <- ROCR::performance( trainRocPred, "auc" )
testAUC      <- ROCR::performance( testRocPred,  "auc" )

rocTrain <- data.frame( trainPerf@x.values, trainPerf@y.values,  trainPerf@alpha.values[[1]] )
rocTest  <- data.frame( testPerf@x.values,  testPerf@y.values,   testPerf@alpha.values[[1]] )

rocNames <- c("recall", "precision", "cutoff")

colnames(rocTrain)    <- rocNames
colnames(rocTest)     <- rocNames

#plot(trainPerf, col=rainbow(10))
#plot(testPerf, col=rainbow(10))

#output <- testAll[ c("XXX", "XXXX", "XXXX", "XXXXX", "XXXXX") ]
#output$Score <- testAllPred
#write.csv( output,     file="./logreg.csv" )

write.csv( rocTest, file="./roc.csv" )

save.image(file="XXXX.RData")


