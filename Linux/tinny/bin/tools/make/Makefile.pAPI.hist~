## histogram for production API

SHELL = /bin/csh -f
OS = $(shell uname)
CUT = /work/price/falcon/$(OS)/bin/ufalcut
COLGREP = /work/price/falcon/$(OS)/bin/colgrep
HIST = ~/tools/perl/mhistogram.pl
CHART = ~krh/tools/chart.pl
FILTERAUTH = ~/tools/perl/filterAuth.pl

DIR = ..
DATA = 

## Some analysis on the data

AUTHJOBS =	auth-post-flag \
				card-post-code \
				card-cntry-code \
				open-date \
				plastic-issue-date \
				plastic-issue-type \
				acct-exp-date \
				card-exp-date \
				num-card \
				card-type \
				card-use \
				tran-date \
				tran-time \
				tran-amt1 \
				tran-curr-code \
				tran-curr-conv \
				auth-decision \
				tran-type \
				sic \
				merch-post \
				merch-cntry \
				pin-verify \
				cvv-verify \
				pos-entry-mode \
				model-used \
				merch-name16 \
				merch-id

## Targets
all: api-jobs

api-jobs:	$(foreach job, $(AUTHJOBS), api.$(job).hist)

# api

api.auth-post-flag.hist : $(DIR)/$(DATA)
	zcat $< | $(CUT) -c56\
	| $(CHART) >! $@

api.card-post-code.hist : $(DIR)/$(DATA)
	zcat $< | $(CUT) -c57-65 \
	| $(CHART) >! $@

api.card-cntry-code.hist : $(DIR)/$(DATA)
	zcat $< | $(CUT) -c66-68 \
	| $(CHART) >! $@

api.open-date.hist : $(DIR)/$(DATA)
	zcat $< | $(CUT) -c69-76 \
	| $(CHART) >! $@

api.plastic-issue-date.hist : $(DIR)/$(DATA)
	zcat $< | $(CUT) -c77-84 \
	| $(CHART) >! $@

api.plastic-issue-type.hist : $(DIR)/$(DATA)
	zcat $< | $(CUT) -c85 \
	| $(CHART) >! $@

api.acct-exp-date.hist : $(DIR)/$(DATA)
	zcat $< | $(CUT) -c86-93 \
	| $(CHART) >! $@

api.card-exp-date.hist : $(DIR)/$(DATA)
	zcat $< | $(CUT) -c94-101 \
	| $(CHART) >! $@

api.num-card.hist : $(DIR)/$(DATA)
	zcat $< | $(CUT) -c131-133 \
	| $(CHART) >! $@

api.card-type.hist : $(DIR)/$(DATA)
	zcat $< | $(CUT) -c144 \
	| $(CHART) >! $@

api.card-use.hist : $(DIR)/$(DATA)
	zcat $< | $(CUT) -c145 \
	| $(CHART) >! $@

api.tran-date.hist : $(DIR)/$(DATA)
	zcat $< | $(CUT) -c146-153 \
	| $(CHART) >! $@

api.tran-time.hist : $(DIR)/$(DATA)
	zcat $< | $(CUT) -c154-159 \
	| $(CHART) >! $@

api.tran-amt1.hist : $(DIR)/$(DATA)
	zcat $< | $(CUT) -c160-169 \
	| $(CHART) >! $@

api.tran-curr-code.hist : $(DIR)/$(DATA)
	zcat $< | $(CUT) -c173-175 \
	| $(CHART) >! $@

api.tran-curr-conv.hist : $(DIR)/$(DATA)
	zcat $< | $(CUT) -c176-188 \
	| $(CHART) >! $@

api.auth-decision.hist : $(DIR)/$(DATA)
	zcat $< | $(CUT) -c189 \
	| $(CHART) >! $@

api.tran-type.hist : $(DIR)/$(DATA)
	zcat $< | $(CUT) -c190 \
	| $(CHART) >! $@

api.sic.hist : $(DIR)/$(DATA)
	zcat $< | $(CUT) -c191-194 \
	| $(CHART) >! $@

api.merch-post.hist : $(DIR)/$(DATA)
	zcat $< | $(CUT) -c195-203 \
	| $(CHART) >! $@

api.merch-cntry.hist : $(DIR)/$(DATA)
	zcat $< | $(CUT) -c204-206 \
	| $(CHART) >! $@

api.pin-verify.hist : $(DIR)/$(DATA)
	zcat $< | $(CUT) -c207 \
	| $(CHART) >! $@

api.cvv-verify.hist : $(DIR)/$(DATA)
	zcat $< | $(CUT) -c208 \
	| $(CHART) >! $@

api.pos-entry-mode.hist : $(DIR)/$(DATA)
	zcat $< | $(CUT) -c209 \
	| $(CHART) >! $@

api.model-used.hist : $(DIR)/$(DATA)
	zcat $< | $(CUT) -c329-336 \
	| $(CHART) >! $@

api.merch-name16.hist : $(DIR)/$(DATA)
	zcat $< | $(CUT) -c399-414 \
	| $(CHART) >! $@

api.merch-id.hist : $(DIR)/$(DATA)
	zcat $< | $(CUT) -c448-457 \
	| $(CHART) >! $@

